<!DOCTYPE html>
<html lang="sl">
<head>
    <meta charset="UTF-8">
    <title>Vizualizacija: Hash Map</title>
    <style>
        :root { --key-color: #0984e3; --val-color: #6c5ce7; --bg: #f5f6fa; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .container { background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); width: 95%; max-width: 700px; text-align: center; }
        
        .map-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin: 30px 0; }
        
        .bucket {
            border: 1px solid #dfe6e9; border-radius: 8px; padding: 10px; background: #fff;
            display: flex; flex-direction: column; align-items: flex-start; min-height: 60px;
        }
        .bucket-header { font-size: 0.7rem; color: #b2bec3; margin-bottom: 8px; border-bottom: 1px solid #eee; width: 100%; text-align: left; }

        .kv-pair {
            display: flex; background: #f1f2f6; border-radius: 4px; overflow: hidden;
            margin-bottom: 5px; font-size: 0.85rem; width: 100%; border: 1px solid #ddd;
            animation: slideIn 0.3s ease-out;
        }
        .k-box { background: var(--key-color); color: white; padding: 4px 8px; font-weight: bold; min-width: 60px; }
        .v-box { padding: 4px 8px; color: #2d3436; flex-grow: 1; text-align: left; }

        @keyframes slideIn { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }

        .controls { display: grid; grid-template-columns: 1fr 1fr auto; gap: 10px; margin-bottom: 20px; }
        input { padding: 10px; border: 2px solid #eee; border-radius: 6px; width: 100%; box-sizing: border-box; }
        button { padding: 10px 20px; cursor: pointer; border: none; border-radius: 6px; font-weight: bold; color: white; background: var(--key-color); }
        
        #status { height: 1.2em; color: #636e72; font-size: 0.9rem; margin-bottom: 10px; }
    </style>
</head>
<body>

    <div class="container">
        <h2>Zgoščeni preslikovalnik (Hash Map)</h2>
        <p>Struktura <b>Ključ-Vrednost</b>. Iskanje po ključu v <b>O(1)</b> času.</p>

        <div class="controls">
            <input type="text" id="keyIn" placeholder="Ključ (npr. 'id')">
            <input type="text" id="valIn" placeholder="Vrednost (npr. 'Janez')">
            <button onclick="setMap()">Shrani (Set)</button>
        </div>
        <p id="status">Vstavite podatke za vizualizacijo zgoščevanja.</p>

        <div class="map-grid" id="mapDisplay">
            <!-- Vedra se generirajo tukaj -->
        </div>
    </div>

    <script>
        const SIZE = 6;
        let internalMap = new Map();
        const display = document.getElementById('mapDisplay');
        const status = document.getElementById('status');

        // Hash funkcija za določitev indeksa (bucket)
        function hash(key) {
            let h = 0;
            const s = String(key);
            for (let i = 0; i < s.length; i++) h += s.charCodeAt(i);
            return h % SIZE;
        }

        function setMap() {
            const k = document.getElementById('keyIn').value.trim();
            const v = document.getElementById('valIn').value.trim();
            
            if (!k || !v) return;

            internalMap.set(k, v);
            status.innerText = `Ključ "${k}" je bil zgoščen v vedro št. ${hash(k)}.`;
            
            render();
            document.getElementById('keyIn').value = '';
            document.getElementById('valIn').value = '';
            document.getElementById('keyIn').focus();
        }

        function render() {
            display.innerHTML = '';
            const buckets = Array.from({ length: SIZE }, () => []);

            // Razporedimo elemente v vedra glede na njihov hash
            internalMap.forEach((val, key) => {
                buckets[hash(key)].push({ key, val });
            });

            buckets.forEach((content, i) => {
                const bDiv = document.createElement('div');
                bDiv.className = 'bucket';
                bDiv.innerHTML = `<div class="bucket-header">VEDRO ${i}</div>`;
                
                content.forEach(pair => {
                    const kvDiv = document.createElement('div');
                    kvDiv.className = 'kv-pair';
                    kvDiv.innerHTML = `
                        <div class="k-box">${pair.key}</div>
                        <div class="v-box">${pair.val}</div>
                    `;
                    bDiv.appendChild(kvDiv);
                });
                
                display.appendChild(bDiv);
            });
        }

        render();
    </script>
</body>
</html>
